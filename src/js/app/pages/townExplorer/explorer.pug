<div>
    <Quickview :town="quickview.town" :origin="quickview.originEvent" @outside-click="hideQuickview"></Quickview>
    <NavBar></NavBar>

    <section class="explorer">
        //- filters
        <simplebar class="filters" ref="filters" data-simplebar-auto-hide="false">
            <div class="filterGroup">
                <aside><img :src="iconGeo" width="50" alt="" /></aside>
                <main>
                    <h1>Périmètre géographique</h1>
                    <Address :autocomplete-function="autocompleteLocation" v-model="location" :show-magnifier="false"></Address>
                </main>
            </div>

            <FilterGroup v-for="filterGroup in allowedFilters" :id="filterGroup.id" :icon="filterGroup.icon" :label="filterGroup.label" :options="filterGroup.options" :opened="filterGroup.opened"></FilterGroup>
        </simplebar>

        //- content
        <div v-bind:style="{ width: !loading && !error ? 'auto' : 0 }" class="content" ref="main">
            <keep-alive>
                <Map v-bind="rendererProps" @town-click="showQuickview" @on-row-click="routeToTown" ref="map"></Map>
            </keep-alive>
        </div>

        //- notifications
        <div v-if="loading" class="notification full-width">
            <img src="/img/spinner_dark.svg" width="20" class="spinner" />
            <span>Chargement des données en cours...</span>
        </div>

        <div v-if="error" class="notification error full-width">
            <span>{{ error }}. <a href="#" @click="fetchData">Réessayer ?</a></span>
        </div>
    </section>
</div>