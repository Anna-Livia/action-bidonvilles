<div>
    <NavBar></NavBar>

    <section class="section section-white" id="form">
        <div class="container">
            <h1>Déclarer un nouveau dispositif</h1>

            <div class="form__group">
                <label v-bind:class="{ error: form.errors.operator }"><sup class="mandatory">(*)</sup> Opérateur :</label>
                <p class="error" v-if="form.errors.operator">
                    <ul>
                        <li v-for="error in form.errors.operator">{{ error }}</li>
                    </ul>
                </p>

                <Operator v-model="form.data.operator" :disabled="form.pending"></Operator>
            </div>

            <div class="form__group">
                <label v-bind:class="{ error: form.errors.planType }"><sup class="mandatory">(*)</sup> Type de dispositif :</label>
                <p class="error" v-if="form.errors.planType">
                    <ul>
                        <li v-for="error in form.errors.planType">{{ error }}</li>
                    </ul>
                </p>
                <div v-for="(type, index) in planTypes">
                    <input type="radio" :id="'planType' + index" :value="type.id" v-model="form.data.planType" :disabled="form.pending">
                    <label :for="'planType' + index" class="label-inline">{{ type.label }}</label>
                </div>
            </div>

            <div class="form__group">
                <label v-bind:class="{ error: form.errors.startedAt }"><sup class="mandatory">(*)</sup> Début du dispositif le :</label>
                <p class="error" v-if="form.errors.startedAt">
                    <ul>
                        <li v-for="error in form.errors.startedAt">{{ error }}</li>
                    </ul>
                </p>
                <datepicker :language="dateLanguage" :monday-first="true" v-model="form.data.startedAt" :full-month-name="true" :format="'dd MMMM yyyy'" :disabled="form.pending"></datepicker>
            </div>

            <div class="form__group">
                <label v-bind:class="{ error: form.errors.funding }"><sup class="mandatory">(*)</sup> Financements :</label>
                <p class="error" v-if="form.errors.funding">
                    <ul>
                        <li v-for="error in form.errors.funding">{{ error }}</li>
                    </ul>
                </p>

                <PlanFunding v-model="form.data.funding" :disabled="form.pending"></PlanFunding>
            </div>

            <div class="form__group">
                <div class="notification error" v-if="form.mainError">{{ form.mainError }}.</div>
            </div>

            <div class="form__group">
                <button class="button large" @click="submit" :disabled="form.pending">
                    <img src="/img/spinner_light.svg" width="20" v-if="form.pending" />
                    <span v-else>Déclarer le dispositif</span>
                </button>
            </div>
    </section>
</div>